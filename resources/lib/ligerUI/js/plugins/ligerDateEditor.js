/**
* jQuery ligerUI 1.1.9
* 
* http://ligerui.com
*  
* Author daomi 2012 [ gd_star@163.com ] 
* 
*/(function(a){a.fn.ligerDateEditor=function(){return a.ligerui.run.call(this,"ligerDateEditor",arguments)},a.fn.ligerGetDateEditorManager=function(){return a.ligerui.run.call(this,"ligerGetDateEditorManager",arguments)},a.ligerDefaults.DateEditor={format:"yyyy-MM-dd hh:mm",showTime:!1,onChangeDate:!1,absolute:!0},a.ligerDefaults.DateEditorString={dayMessage:["日","一","二","三","四","五","六"],monthMessage:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],todayMessage:"今天",closeMessage:"关闭"},a.ligerMethos.DateEditor={},a.ligerui.controls.DateEditor=function(b,c){a.ligerui.controls.DateEditor.base.constructor.call(this,b,c)},a.ligerui.controls.DateEditor.ligerExtend(a.ligerui.controls.Input,{__getType:function(){return"DateEditor"},__idPrev:function(){return"DateEditor"},_extendMethods:function(){return a.ligerMethos.DateEditor},_render:function(){var b=this,c=this.options;!c.showTime&&c.format.indexOf(" hh:mm")>-1&&(c.format=c.format.replace(" hh:mm",""));if(this.element.tagName.toLowerCase()=="input"&&this.element.type=="text"){b.inputText=a(this.element),b.inputText.hasClass("l-text-field")||b.inputText.addClass("l-text-field"),b.link=a('<div class="l-trigger"><div class="l-trigger-icon"></div></div>'),b.text=b.inputText.wrap('<div class="l-text l-text-date"></div>').parent(),b.text.append('<div class="l-text-l"></div><div class="l-text-r"></div>'),b.text.append(b.link),b.textwrapper=b.text.wrap('<div class="l-text-wrapper"></div>').parent();var d="";d+="<div class='l-box-dateeditor' style='display:none'>",d+="    <div class='l-box-dateeditor-header'>",d+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-prevyear'><span></span></div>",d+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-prevmonth'><span></span></div>",d+="        <div class='l-box-dateeditor-header-text'><a class='l-box-dateeditor-header-month'></a> , <a  class='l-box-dateeditor-header-year'></a></div>",d+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-nextmonth'><span></span></div>",d+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-nextyear'><span></span></div>",d+="    </div>",d+="    <div class='l-box-dateeditor-body'>",d+="        <table cellpadding='0' cellspacing='0' border='0' class='l-box-dateeditor-calendar'>",d+="            <thead>",d+="                <tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr>",d+="            </thead>",d+="            <tbody>",d+="                <tr class='l-first'><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr>",d+="            </tbody>",d+="        </table>",d+="        <ul class='l-box-dateeditor-monthselector'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>",d+="        <ul class='l-box-dateeditor-yearselector'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>",d+="        <ul class='l-box-dateeditor-hourselector'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>",d+="        <ul class='l-box-dateeditor-minuteselector'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>",d+="    </div>",d+="    <div class='l-box-dateeditor-toolbar'>",d+="        <div class='l-box-dateeditor-time'></div>",d+="        <div class='l-button l-button-today'></div>",d+="        <div class='l-button l-button-close'></div>",d+="        <div class='l-clear'></div>",d+="    </div>",d+="</div>",b.dateeditor=a(d),c.absolute?b.dateeditor.appendTo("body").addClass("l-box-dateeditor-absolute"):b.textwrapper.append(b.dateeditor),b.header=a(".l-box-dateeditor-header",b.dateeditor),b.body=a(".l-box-dateeditor-body",b.dateeditor),b.toolbar=a(".l-box-dateeditor-toolbar",b.dateeditor),b.body.thead=a("thead",b.body),b.body.tbody=a("tbody",b.body),b.body.monthselector=a(".l-box-dateeditor-monthselector",b.body),b.body.yearselector=a(".l-box-dateeditor-yearselector",b.body),b.body.hourselector=a(".l-box-dateeditor-hourselector",b.body),b.body.minuteselector=a(".l-box-dateeditor-minuteselector",b.body),b.toolbar.time=a(".l-box-dateeditor-time",b.toolbar),b.toolbar.time.hour=a("<a></a>"),b.toolbar.time.minute=a("<a></a>"),b.buttons={btnPrevYear:a(".l-box-dateeditor-header-prevyear",b.header),btnNextYear:a(".l-box-dateeditor-header-nextyear",b.header),btnPrevMonth:a(".l-box-dateeditor-header-prevmonth",b.header),btnNextMonth:a(".l-box-dateeditor-header-nextmonth",b.header),btnYear:a(".l-box-dateeditor-header-year",b.header),btnMonth:a(".l-box-dateeditor-header-month",b.header),btnToday:a(".l-button-today",b.toolbar),btnClose:a(".l-button-close",b.toolbar)};var e=new Date;b.now={year:e.getFullYear(),month:e.getMonth()+1,day:e.getDay(),date:e.getDate(),hour:e.getHours(),minute:e.getMinutes()},b.currentDate={year:e.getFullYear(),month:e.getMonth()+1,day:e.getDay(),date:e.getDate(),hour:e.getHours(),minute:e.getMinutes()},b.selectedDate=null,b.usedDate=null,a("td",b.body.thead).each(function(b,d){a(d).html(c.dayMessage[b])}),a("li",b.body.monthselector).each(function(b,d){a(d).html(c.monthMessage[b])}),b.buttons.btnToday.html(c.todayMessage),b.buttons.btnClose.html(c.closeMessage),c.showTime&&(b.toolbar.time.show(),b.toolbar.time.append(b.toolbar.time.hour).append(":").append(b.toolbar.time.minute),a("li",b.body.hourselector).each(function(b,c){var d=b;b<10&&(d="0"+b.toString()),a(this).html(d)}),a("li",b.body.minuteselector).each(function(b,c){var d=b;b<10&&(d="0"+b.toString()),a(this).html(d)})),b.bulidContent(),b.inputText.val()!=""&&b.onTextChange(),b.dateeditor.hover(null,function(a){b.dateeditor.is(":visible")&&!b.editorToggling&&b.toggleDateEditor(!0)}),b.link.hover(function(){c.disabled||(this.className="l-trigger-hover")},function(){c.disabled||(this.className="l-trigger")}).mousedown(function(){c.disabled||(this.className="l-trigger-pressed")}).mouseup(function(){c.disabled||(this.className="l-trigger-hover")}).click(function(){c.disabled||(b.bulidContent(),b.toggleDateEditor(b.dateeditor.is(":visible")))}),c.disabled&&(b.inputText.attr("readonly","readonly"),b.text.addClass("l-text-disabled")),c.initValue&&b.inputText.val(c.initValue),b.buttons.btnClose.click(function(){b.toggleDateEditor(!0)}),a("td",b.body.tbody).hover(function(){a(this).hasClass("l-box-dateeditor-today")||a(this).addClass("l-box-dateeditor-over")},function(){a(this).removeClass("l-box-dateeditor-over")}).click(function(){a(".l-box-dateeditor-selected",b.body.tbody).removeClass("l-box-dateeditor-selected"),a(this).hasClass("l-box-dateeditor-today")||a(this).addClass("l-box-dateeditor-selected"),b.currentDate.date=parseInt(a(this).html()),b.currentDate.day=(new Date(b.currentDate.year,b.currentDate.month-1,1)).getDay(),a(this).hasClass("l-box-dateeditor-out")&&(a("tr",b.body.tbody).index(a(this).parent())==0?--b.currentDate.month==0&&(b.currentDate.month=12,b.currentDate.year--):++b.currentDate.month==13&&(b.currentDate.month=1,b.currentDate.year++)),b.selectedDate={year:b.currentDate.year,month:b.currentDate.month,date:b.currentDate.date},b.showDate(),b.editorToggling=!0,b.dateeditor.slideToggle("fast",function(){b.editorToggling=!1})}),a(".l-box-dateeditor-header-btn",b.header).hover(function(){a(this).addClass("l-box-dateeditor-header-btn-over")},function(){a(this).removeClass("l-box-dateeditor-header-btn-over")}),b.buttons.btnYear.click(function(){b.body.yearselector.is(":visible")||a("li",b.body.yearselector).each(function(c,d){var e=b.currentDate.year+(c-4);e==b.currentDate.year?a(this).addClass("l-selected"):a(this).removeClass("l-selected"),a(this).html(e)}),b.body.yearselector.slideToggle()}),b.body.yearselector.hover(function(){},function(){a(this).slideUp()}),a("li",b.body.yearselector).click(function(){b.currentDate.year=parseInt(a(this).html()),b.body.yearselector.slideToggle(),b.bulidContent()}),b.buttons.btnMonth.click(function(){a("li",b.body.monthselector).each(function(c,d){b.currentDate.month==c+1?a(this).addClass("l-selected"):a(this).removeClass("l-selected")}),b.body.monthselector.slideToggle()}),b.body.monthselector.hover(function(){},function(){a(this).slideUp("fast")}),a("li",b.body.monthselector).click(function(){var c=a("li",b.body.monthselector).index(this);b.currentDate.month=c+1,b.body.monthselector.slideToggle(),b.bulidContent()}),b.toolbar.time.hour.click(function(){a("li",b.body.hourselector).each(function(c,d){b.currentDate.hour==c?a(this).addClass("l-selected"):a(this).removeClass("l-selected")}),b.body.hourselector.slideToggle()}),b.body.hourselector.hover(function(){},function(){a(this).slideUp("fast")}),a("li",b.body.hourselector).click(function(){var c=a("li",b.body.hourselector).index(this);b.currentDate.hour=c,b.body.hourselector.slideToggle(),b.bulidContent()}),b.toolbar.time.minute.click(function(){a("li",b.body.minuteselector).each(function(c,d){b.currentDate.minute==c?a(this).addClass("l-selected"):a(this).removeClass("l-selected")}),b.body.minuteselector.slideToggle("fast",function(){var b=a("li",this).index(a("li.l-selected",this));if(b>29){var c=a("li.l-selected",this).offset().top-a(this).offset().top;a(this).animate({scrollTop:c})}})}),b.body.minuteselector.hover(function(){},function(){a(this).slideUp("fast")}),a("li",b.body.minuteselector).click(function(){var c=a("li",b.body.minuteselector).index(this);b.currentDate.minute=c,b.body.minuteselector.slideToggle("fast"),b.bulidContent()}),b.buttons.btnPrevMonth.click(function(){--b.currentDate.month==0&&(b.currentDate.month=12,b.currentDate.year--),b.bulidContent()}),b.buttons.btnNextMonth.click(function(){++b.currentDate.month==13&&(b.currentDate.month=1,b.currentDate.year++),b.bulidContent()}),b.buttons.btnPrevYear.click(function(){b.currentDate.year--,b.bulidContent()}),b.buttons.btnNextYear.click(function(){b.currentDate.year++,b.bulidContent()}),b.buttons.btnToday.click(function(){b.currentDate={year:b.now.year,month:b.now.month,day:b.now.day,date:b.now.date},b.selectedDate={year:b.now.year,month:b.now.month,day:b.now.day,date:b.now.date},b.showDate(),b.dateeditor.slideToggle("fast")}),b.inputText.change(function(){b.onTextChange()}).blur(function(){b.text.removeClass("l-text-focus")}).focus(function(){b.text.addClass("l-text-focus")}),b.text.hover(function(){b.text.addClass("l-text-over")},function(){b.text.removeClass("l-text-over")}),c.label&&(b.labelwrapper=b.textwrapper.wrap('<div class="l-labeltext"></div>').parent(),b.labelwrapper.prepend('<div class="l-text-label" style="float:left;display:inline;">'+c.label+":&nbsp</div>"),b.textwrapper.css("float","left"),c.labelWidth?a(".l-text-label",b.labelwrapper).outerWidth(c.labelWidth):c.labelWidth=a(".l-text-label",b.labelwrapper).outerWidth(),a(".l-text-label",b.labelwrapper).width(c.labelWidth),a(".l-text-label",b.labelwrapper).height(b.text.height()),b.labelwrapper.append('<br style="clear:both;" />'),c.labelAlign&&a(".l-text-label",b.labelwrapper).css("text-align",c.labelAlign),b.textwrapper.css({display:"inline"}),b.labelwrapper.width(b.text.outerWidth()+c.labelWidth+2)),b.set(c)}},destroy:function(){this.textwrapper&&this.textwrapper.remove(),this.dateeditor&&this.dateeditor.remove(),this.options=null,a.ligerui.remove(this)},bulidContent:function(){var b=this,c=this.options,d=(new Date(b.currentDate.year,b.currentDate.month-1,1)).getDay(),e=b.currentDate.month,f=b.currentDate.year;++e==13&&(e=1,f++);var g=(new Date(f,e-1,0)).getDate(),h=(new Date(b.currentDate.year,b.currentDate.month-1,0)).getDate();b.buttons.btnMonth.html(c.monthMessage[b.currentDate.month-1]),b.buttons.btnYear.html(b.currentDate.year),b.toolbar.time.hour.html(b.currentDate.hour),b.toolbar.time.minute.html(b.currentDate.minute),b.toolbar.time.hour.html().length==1&&b.toolbar.time.hour.html("0"+b.toolbar.time.hour.html()),b.toolbar.time.minute.html().length==1&&b.toolbar.time.minute.html("0"+b.toolbar.time.minute.html()),a("td",this.body.tbody).each(function(){this.className=""}),a("tr",this.body.tbody).each(function(c,e){a("td",e).each(function(e,f){var j=c*7+(e-d),k=j+1;b.selectedDate&&b.currentDate.year==b.selectedDate.year&&b.currentDate.month==b.selectedDate.month&&j+1==b.selectedDate.date?((e==0||e==6)&&a(f).addClass("l-box-dateeditor-holiday"),a(f).addClass("l-box-dateeditor-selected"),a(f).siblings().removeClass("l-box-dateeditor-selected")):b.currentDate.year==b.now.year&&b.currentDate.month==b.now.month&&j+1==b.now.date?((e==0||e==6)&&a(f).addClass("l-box-dateeditor-holiday"),a(f).addClass("l-box-dateeditor-today")):j<0?(k=h+k,a(f).addClass("l-box-dateeditor-out").removeClass("l-box-dateeditor-selected")):j>g-1?(k=k-g,a(f).addClass("l-box-dateeditor-out").removeClass("l-box-dateeditor-selected")):e==0||e==6?a(f).addClass("l-box-dateeditor-holiday").removeClass("l-box-dateeditor-selected"):f.className="",a(f).html(k)})})},updateSelectBoxPosition:function(){var b=this,c=this.options;c.absolute?b.dateeditor.css({left:b.text.offset().left,top:b.text.offset().top+1+b.text.outerHeight()}):b.text.offset().top+4>b.dateeditor.height()&&b.text.offset().top+b.dateeditor.height()+textHeight+4-a(window).scrollTop()>a(window).height()?(b.dateeditor.css("marginTop",-1*(b.dateeditor.height()+textHeight+5)),b.showOnTop=!0):b.showOnTop=!1},toggleDateEditor:function(a){var b=this,c=this.options,d=b.text.height();b.editorToggling=!0,a?b.dateeditor.hide("fast",function(){b.editorToggling=!1}):(b.updateSelectBoxPosition(),b.dateeditor.slideDown("fast",function(){b.editorToggling=!1}))},showDate:function(){var a=this,b=this.options;if(!!this.selectedDate){var c=a.selectedDate.year+"/"+a.selectedDate.month+"/"+a.selectedDate.date;this.currentDate.hour=parseInt(a.toolbar.time.hour.html(),10),this.currentDate.minute=parseInt(a.toolbar.time.minute.html(),10),b.showTime&&(c+=" "+this.currentDate.hour+":"+this.currentDate.minute),this.inputText.val(c),this.inputText.trigger("change").focus()}},isDateTime:function(a){var b=this,c=this.options,d=a.match(/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/);if(d==null)return!1;var e=new Date(d[1],d[3]-1,d[4]);if(e=="NaN")return!1;return e.getFullYear()==d[1]&&e.getMonth()+1==d[3]&&e.getDate()==d[4]},isLongDateTime:function(a){var b=this,c=this.options,d=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2}) (\d{1,2}):(\d{1,2})$/,e=a.match(d);if(e==null)return!1;var f=new Date(e[1],e[3]-1,e[4],e[5],e[6]);if(f=="NaN")return!1;return f.getFullYear()==e[1]&&f.getMonth()+1==e[3]&&f.getDate()==e[4]&&f.getHours()==e[5]&&f.getMinutes()==e[6]},getFormatDate:function(a){var b=this,c=this.options;if(a=="NaN")return null;var d=c.format,e={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};/(y+)/.test(d)&&(d=d.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length)));for(var f in e)(new RegExp("("+f+")")).test(d)&&(d=d.replace(RegExp.$1,RegExp.$1.length==1?e[f]:("00"+e[f]).substr((""+e[f]).length)));return d},onTextChange:function(){var b=this,c=this.options,d=b.inputText.val();if(d==""){b.selectedDate=null;return!0}if(!c.showTime&&!b.isDateTime(d))b.usedDate?b.inputText.val(b.getFormatDate(b.usedDate)):b.inputText.val("");else if(c.showTime&&!b.isLongDateTime(d))b.usedDate?b.inputText.val(b.getFormatDate(b.usedDate)):b.inputText.val("");else{d=d.replace(/-/g,"/");var e=b.getFormatDate(new Date(d));e==null&&(b.usedDate?b.inputText.val(b.getFormatDate(b.usedDate)):b.inputText.val("")),b.usedDate=new Date(d),b.selectedDate={year:b.usedDate.getFullYear(),month:b.usedDate.getMonth()+1,day:b.usedDate.getDay(),date:b.usedDate.getDate(),hour:b.usedDate.getHours(),minute:b.usedDate.getMinutes()},b.currentDate={year:b.usedDate.getFullYear(),month:b.usedDate.getMonth()+1,day:b.usedDate.getDay(),date:b.usedDate.getDate(),hour:b.usedDate.getHours(),minute:b.usedDate.getMinutes()},b.inputText.val(e),b.trigger("changeDate",[e]),a(b.dateeditor).is(":visible")&&b.bulidContent()}},_setHeight:function(a){var b=this;a>4&&(b.text.css({height:a}),b.inputText.css({height:a}),b.textwrapper.css({height:a}))},_setWidth:function(a){var b=this;a>20&&(b.text.css({width:a}),b.inputText.css({width:a-20}),b.textwrapper.css({width:a}))},_setValue:function(a){var b=this;a||b.inputText.val(""),typeof a=="string"?b.inputText.val(a):typeof a=="object"&&a instanceof Date&&(b.inputText.val(b.getFormatDate(a)),b.onTextChange())},_getValue:function(){return this.usedDate},setEnabled:function(){var a=this,b=this.options;this.inputText.removeAttr("readonly"),this.text.removeClass("l-text-disabled"),b.disabled=!1},setDisabled:function(){var a=this,b=this.options;this.inputText.attr("readonly","readonly"),this.text.addClass("l-text-disabled"),b.disabled=!0}})})(jQuery)